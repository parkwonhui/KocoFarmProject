<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.kocofarm.mapper.module.ApprovalMapper">
	<!-- 기본 기안서 정보 입력 -->
	<insert id="insertDraft" parameterType="org.kocofarm.domain.approval.ApprDraftVO">
		insert into Draft
		values(seq_draft.nextval,#{draftName},SYSDATE,#{draftTitle},#{empId},#{draftYear},#{formId},#{approveState})
	</insert>
	<insert id="insertDraftSelectKey" parameterType="org.kocofarm.domain.approval.ApprDraftVO">
		<selectKey keyProperty="draftId" order="BEFORE" resultType="long">
			insert into Draft
			values(#{draftId},#{draftName},SYSDATE,#{draftTitle},#{empId},#{draftYear},#{formId},#{approveState})
		</selectKey>
	</insert>
<!-- 휴가 신청서 입력  -->
 	<insert id = "insertVacation" parameterType = "org.kocofarm.domain.approval.ApprVacationVO">
		insert into Vacation_Form values(seq_vacation.nextval,${draftId},${formId},SYSDATE,SYSDATE,#{vacationType},#{vacationDays},
		#{vacationReason},#{replacementId})
	</insert>

	<!-- 기안서 양식 list -->
	<select id = "listForm" resultType = "org.kocofarm.domain.approval.ApprFormVO"> 
		select FORM_ID AS formId, SORT_ID AS sortId, SORT_NAME AS sortName, MODE_ID 
		AS modeId, MODE_NAME AS modeName from FORM order by FORM_ID </select>


	<!-- 기본 draft 불러오기 -->
	<select id="listDraft" resultType="org.kocofarm.domain.approval.ApprDraftVO"> 
		SELECT DRAFT_ID AS draftId, DRAFT_NAME AS draftName, DRAFT_DT AS draftDt, 
		DRAFT_TITLE AS draftTitle, EMP_ID AS empId, DRAFT_YEAR AS draftYear, FORM_ID 
		AS formId, APPROVE_STATE AS approveState FROM DRAFT WHERE DRAFT_ID = #{draftId} 
		</select>

</mapper>